<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pengumuman Kelulusan SD Negeri 2 Palapi</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      background: linear-gradient(135deg, #d1fae5, #f3e8ff);
      font-family: 'Poppins', sans-serif;
      margin: 0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 1.5rem;
      flex-grow: 1;
    }
    .logo {
      max-width: 100px;
      transition: transform 0.4s ease, filter 0.3s ease;
      filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.1));
    }
    .logo:hover {
      transform: scale(1.15) rotate(5deg);
      filter: drop-shadow(0 6px 8px rgba(0, 0, 0, 0.2));
    }
    .card {
      background: rgba(255, 255, 255, 0.9);
      border-radius: 1.25rem;
      box-shadow: 0 12px 24px rgba(0, 0, 0, 0.15);
      backdrop-filter: blur(12px);
      transition: transform 0.3s ease;
    }
    .card:hover {
      transform: translateY(-5px);
    }
    .result-card {
      border: 2px solid transparent;
      background: linear-gradient(white, white) padding-box,
                  linear-gradient(to right, #c084fc, #60a5fa) border-box;
    }
    .input-nisn {
      background-color: #ecfdf5;
      border: 2px solid #a5f3fc;
      padding: 0.75rem;
      border-radius: 0.75rem;
      transition: all 0.3s ease;
      width: 100%;
      font-size: 1rem;
    }
    .input-nisn:focus {
      outline: none;
      border-color: #c084fc;
      box-shadow: 0 0 0 4px rgba(192, 132, 252, 0.2);
    }
    .btn-check {
      background: linear-gradient(45deg, #c084fc, #60a5fa);
      padding: 0.75rem 2rem;
      border-radius: 3rem;
      color: white;
      font-weight: 700;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    .btn-check::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transition: left 0.4s ease;
    }
    .btn-check:hover::before {
      left: 100%;
    }
    .btn-check:hover {
      transform: scale(1.05);
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
    }
    .btn-check:disabled {
      background: #d1d5db;
      cursor: not-allowed;
    }
    .student-photo {
      width: 120px;
      height: 120px;
      object-fit: cover;
      border-radius: 50%;
      border: 4px solid transparent;
      background: linear-gradient(white, white) padding-box,
                  linear-gradient(to right, #c084fc, #60a5fa) border-box;
      margin-bottom: 1rem;
      transition: transform 0.3s ease;
    }
    .student-photo:hover {
      transform: scale(1.1);
    }
    .motivasi {
      font-style: italic;
      color: #4b5563;
      background-color: #ecfdf5;
      padding: 1rem;
      border-radius: 0.75rem;
      margin-top: 1.5rem;
      border-left: 4px solid #60a5fa;
    }
    .footer {
      text-align: center;
      color: #4b5563;
      padding: 1rem 0;
      font-size: 0.875rem;
      font-weight: 500;
    }
    .hidden {
      display: none;
    }
    .fade-in {
      animation: fadeIn 0.6s ease-in;
    }
    .loading::after {
      content: 'Memuat...';
      display: inline-block;
      animation: dots 1.5s infinite;
    }
    @keyframes dots {
      0% { content: 'Memuat.'; }
      33% { content: 'Memuat..'; }
      66% { content: 'Memuat...'; }
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(15px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @media (max-width: 640px) {
      .container {
        padding: 1rem;
      }
      .logo {
        max-width: 80px;
      }
      .student-photo {
        width: 100px;
        height: 100px;
      }
      h1 {
        font-size: 1.75rem;
      }
      h2 {
        font-size: 1.25rem;
      }
      p {
        font-size: 0.875rem;
      }
      .btn-check {
        padding: 0.5rem 1.5rem;
      }
      .card {
        padding: 1rem;
      }
    }
    @media (max-width: 480px) {
      .input-nisn {
        font-size: 0.875rem;
      }
      .motivasi {
        font-size: 0.75rem;
      }
    }
  </style>
</head>
<body>
  <div class="container mx-auto">
    <div class="text-center mb-6">
      <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEifYwgnCNmNul_iDmeHlmtD4aH3JzjFDeeCOs3kQhA-KrQV6LDV11QxVxIwpzCwClO6HpCvTw9rcWEzFLritwGyZFltnImveRb94uFpWpCKT7Cn_ye6Ho3LZqrSaIGh_Ja5prXuj228ES-fXsr9VNN0KsNoZy3zP4nUteS7rqqx4SwHrGKfgJ40i-K9NQ13/s320/logo%20sekolah.png" alt="Logo SD Negeri 2 Palapi" class="logo mx-auto">
      <br>
      <h2 class="text-2xl font-semibold text-gray-700">Pengumuman Kelulusan</h2>
      <h1 class="text-4xl font-bold text-purple-600 mb-2">SD Negeri 2 Palapi</h1>
      <p class="text-lg text-gray-600">Kecamatan Muara Uya, Kabupaten Tabalong<br>NPSN: 30302932<br>Tahun Ajaran 2024/2025</p>
    </div>

    <div class="card p-6 mb-6">
      <h2 class="text-2xl font-semibold text-gray-800 mb-4 text-center">Cek Kelulusanmu!</h2>
      <div class="mb-4">
        <label for="nisn" class="block text-sm font-medium text-gray-700 mb-2 text-center">Masukkan NISN</label>
        <input type="text" id="nisn" class="input-nisn text-center" placeholder="Ketik NISN kamu di sini" maxlength="10" pattern="[0-9]{10}">
      </div>
      <div class="text-center">
        <button id="check-btn" onclick="checkNISN()" class="btn-check">Cek Sekarang</button>
      </div>
    </div>

    <div id="result" class="card p-6 hidden fade-in result-card">
      <div class="text-center">
        <img id="student-photo" class="student-photo mx-auto" src="" alt="Foto Siswa" onerror="this.src='https://via.placeholder.com/150';">
      </div>
      <div class="text-center mt-4">
        <p id="nama" class="text-lg font-semibold text-gray-800"></p>
        <p id="nis" class="text-gray-600"></p>
        <p id="jk" class="text-gray-600"></p>
        <p id="nisn-result" class="text-gray-600"></p>
        <p id="ttl" class="text-gray-600"></p>
        <p id="keterangan" class="text-xl font-bold text-purple-600 mt-4"></p>
        <p id="ucapan" class="text-2xl font-bold text-green-500 mt-2"></p>
        <p id="motivasi" class="motivasi"></p>
      </div>
    </div>

    <footer class="footer">
      Â© 2025 | Minda SD Negeri 2 Palapi. All Right reserved.
    </footer>
  </div>

  <script>
    const motivasi = [
      "Keep shining, ilmu adalah cahaya yang bakal bawa kamu jauh!",
      "Belajar itu kayak nge-unlock level baru di game, terus push rank!",
      "Jangan takut gagal, setiap pelajaran bikin kamu lebih OP!",
      "Ilmu adalah skin terbaik yang bisa kamu equip untuk masa depan.",
      "Stay curious, dunia ini penuh dengan side quest yang keren!"
    ];

    function getRandomMotivasi() {
      return motivasi[Math.floor(Math.random() * motivasi.length)];
    }

    async function checkNISN() {
      const nisnInput = document.getElementById('nisn');
      const checkBtn = document.getElementById('check-btn');
      const nisn = nisnInput.value.trim();

      // Validate NISN
      if (!nisn) {
        alert('Yah, NISN-nya jangan lupa diisi ya!');
        return;
      }
      if (!/^\d{10}$/.test(nisn)) {
        alert('NISN harus 10 digit angka!');
        return;
      }

      // Show loading state
      checkBtn.disabled = true;
      checkBtn.classList.add('loading');
      checkBtn.textContent = '';

      try {
        const response = await fetch(`https://script.google.com/macros/s/AKfycbyNdWlYQjO7KM3KGIWbu01uef3R2ODjVSKfO_UGXVcMMNG8CEhG4fI1ke6StYfnIUXC/exec?nisn=${nisn}`, {
          method: 'GET',
          headers: {
            'Accept': 'application/json'
          }
        });

        if (!response.ok) {
          throw new Error(`Server error: ${response.status}`);
        }

        const data = await response.json();
        console.log('Photo URL:', data.Link_Foto); // Debug photo URL
        displayResult(data);
      } catch (error) {
        alert('Oops, ada masalah saat menghubungi server! Coba lagi nanti ya.');
        console.error('Error:', error);
      } finally {
        // Reset button state
        checkBtn.disabled = false;
        checkBtn.classList.remove('loading');
        checkBtn.textContent = 'Cek Sekarang';
      }
    }

    function displayResult(data) {
      const resultDiv = document.getElementById('result');
      if (!data || data.error || !data.Nama) {
        alert('NISN tidak ditemukan, cek lagi yuk!');
        return;
      }

      document.getElementById('student-photo').src = data.Link_Foto || 'https://via.placeholder.com/150';
      document.getElementById('nama').innerText = data.Nama || 'N/A';
      document.getElementById('nis').innerText = `NIS: ${data.NIS || 'N/A'}`;
      document.getElementById('jk').innerText = `Jenis Kelamin: ${data.JK || 'N/A'}`;
      document.getElementById('nisn-result').innerText = `NISN: ${data.NISN || 'N/A'}`;
      document.getElementById('ttl').innerText = `TTL: ${data.TTL || 'N/A'}`;
      document.getElementById('keterangan').innerText = `Status Kelulusan: ${data.KETERANGAN || 'N/A'}`;
      document.getElementById('ucapan').innerText = data.KETERANGAN && data.KETERANGAN.toLowerCase() === 'lulus' ? 'Yay, kamu LULUS! ðŸŽ‰' : '';
      document.getElementById('motivasi').innerText = getRandomMotivasi();
      resultDiv.classList.remove('hidden');
    }
  </script>
</body>
</html>
