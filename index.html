<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pengumuman Kelulusan SD Negeri 2 Palapi</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      background: linear-gradient(135deg, #e0f7fa, #f3e8ff);
      font-family: 'Poppins', sans-serif;
      margin: 0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      overflow-x: hidden;
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 2rem;
      flex-grow: 1;
    }
    .logo {
      max-width: 100px;
      transition: transform 0.4s ease, filter 0.3s ease;
      filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.1));
    }
    .logo:hover {
      transform: scale(1.1) rotate(5deg);
      filter: drop-shadow(0 6px 8px rgba(0, 0, 0, 0.2));
    }
    .card {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 1.5rem;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
      backdrop-filter: blur(10px);
      transition: transform 0.3s ease, opacity 0.5s ease;
      padding: 2rem;
    }
    .card:hover {
      transform: translateY(-3px);
    }
    .result-card {
      border: 3px solid transparent;
      background: linear-gradient(white, white) padding-box,
                  linear-gradient(45deg, #a78bfa, #60a5fa) border-box;
    }
    .input-nisn {
      background-color: #f0fdfa;
      border: 2px solid #a5f3fc;
      padding: 0.75rem 1rem;
      border-radius: 0.75rem;
      transition: all 0.3s ease;
      width: 100%;
      font-size: 1rem;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    }
    .input-nisn:focus {
      outline: none;
      border-color: #a78bfa;
      box-shadow: 0 0 0 4px rgba(167, 139, 250, 0.2);
    }
    .btn-check, .btn-back {
      background: linear-gradient(45deg, #a78bfa, #60a5fa);
      padding: 0.75rem 2.5rem;
      border-radius: 2rem;
      color: white;
      font-weight: 600;
      font-size: 1rem;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
    .btn-check::before, .btn-back::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transition: left 0.4s ease;
    }
    .btn-check:hover::before, .btn-back:hover::before {
      left: 100%;
    }
    .btn-check:hover, .btn-back:hover {
      transform: scale(1.05);
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
    }
    .btn-check:disabled {
      background: #d1d5db;
      cursor: not-allowed;
      box-shadow: none;
    }
    .student-photo {
      width: 120px;
      height: 120px;
      object-fit: cover;
      border-radius: 50%;
      border: 3px solid transparent;
      background: linear-gradient(white, white) padding-box,
                  linear-gradient(45deg, #a78bfa, #60a5fa) border-box;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      transition: transform 0.3s ease;
    }
    .student-photo:hover {
      transform: scale(1.05);
    }
    .motivasi {
      font-style: italic;
      color: #4b5563;
      background-color: #f0fdfa;
      padding: 1rem 1.5rem;
      border-radius: 0.75rem;
      border-left: 4px solid #60a5fa;
      font-size: 0.95rem;
      max-width: 500px;
      margin: 0 auto;
    }
    .footer {
      text-align: center;
      color: #4b5563;
      padding: 1.5rem 0;
      font-size: 0.875rem;
      font-weight: 500;
    }
    .divider {
      border-top: 1px solid #e5e7eb;
      margin: 1.5rem 0;
    }
    .hidden {
      display: none;
      opacity: 0;
    }
    .fade-in {
      animation: fadeIn 0.6s ease-in forwards;
    }
    .loading::after {
      content: 'Memuat...';
      display: inline-block;
      animation: dots 1.5s infinite;
    }
    @keyframes dots {
      0% { content: 'Memuat.'; }
      33% { content: 'Memuat..'; }
      66% { content: 'Memuat...'; }
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @media (max-width: 640px) {
      .container {
        padding: 1.5rem;
      }
      .logo {
        max-width: 80px;
      }
      .student-photo {
        width: 100px;
        height: 100px;
      }
      h1 {
        font-size: 1.75rem;
      }
      h2 {
        font-size: 1.25rem;
      }
      p {
        font-size: 0.875rem;
      }
      .btn-check, .btn-back {
        padding: 0.6rem 2rem;
        font-size: 0.9rem;
      }
      .card {
        padding: 1.5rem;
      }
      .motivasi {
        font-size: 0.85rem;
      }
    }
    @media (max-width: 480px) {
      .input-nisn {
        font-size: 0.875rem;
      }
    }
  </style>
</head>
<body>
  <div class="container mx-auto">
    <div class="text-center mb-8">
      <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEifYwgnCNmNul_iDmeHlmtD4aH3JzjFDeeCOs3kQhA-KrQV6LDV11QxVxIwpzCwClO6HpCvTw9rcWEzFLritwGyZFltnImveRb94uFpWpCKT7Cn_ye6Ho3LZqrSaIGh_Ja5prXuj228ES-fXsr9VNN0KsNoZy3zP4nUteS7rqqx4SwHrGKfgJ40i-K9NQ13/s320/logo%20sekolah.png" alt="Logo SD Negeri 2 Palapi" class="logo mx-auto">
      <h2 class="text-2xl font-semibold text-gray-700 mt-4">Pengumuman Kelulusan</h2>
      <h1 class="text-4xl font-bold text-purple-700 mb-2">SD Negeri 2 Palapi</h1>
      <p class="text-lg text-gray-600">Kecamatan Muara Uya, Kabupaten Tabalong<br>NPSN: 30302932<br>Tahun Ajaran 2024/2025</p>
    </div>

    <div id="check-section" class="card mb-8 fade-in">
      <h2 class="text-2xl font-semibold text-gray-800 mb-4 text-center">Cek Kelulusanmu!</h2>
      <div class="mb-4 max-w-md mx-auto">
        <label for="nisn" class="block text-sm font despot-medium text-gray-700 mb-2 text-center">Masukkan NISN</label>
        <input type="text" id="nisn" class="input-nisn text-center" placeholder="Ketik NISN kamu di sini" maxlength="10" pattern="[0-9]{10}" aria-label="Masukkan NISN">
      </div>
      <div class="text-center">
        <button id="check-btn" onclick="checkNISN()" class="btn-check">Cek Sekarang</button>
      </div>
    </div>

    <div id="result" class="card hidden result-card fade-in">
      <div class="text-center mb-6">
        <img id="student-photo" class="student-photo mx-auto" src="" alt="Foto Siswa" onerror="this.src='https://via.placeholder.com/150';" aria-label="Foto siswa">
      </div>
      <div class="student-data text-center mb-6">
        <p id="nama" class="text-2xl font-semibold text-gray-800 mb-3"></p>
        <p id="nis" class="text-gray-600 text-base mb-1"></p>
        <p id="jk" class="text-gray-600 text-base mb-1"></p>
        <p id="nisn-result" class="text-gray-600 text-base mb-1"></p>
        <p id="ttl" class="text-gray-600 text-base mb-1"></p>
      </div>
      <div class="divider"></div>
      <div class="text-center">
        <p id="keterangan" class="text-2xl font-bold text-purple-700 mb-4"></p>
        <p id="ucapan" class="text-3xl font-bold text-green-600 mb-4"></p>
        <p id="motivasi" class="motivasi mb-6"></p>
        <button id="back-btn" onclick="backToCheck()" class="btn-back" aria-label="Kembali ke pengecekan">Kembali</button>
      </div>
    </div>

    <footer class="footer">
      Â© 2025 | Minda SD Negeri 2 Palapi. All Rights Reserved.
    </footer>
  </div>

  <script>
    const motivasi = [
      "Perjalanan kamu baru dimulai. Jangan buru-buru jadi hebat â€” cukup jadi penasaran setiap hari.",
  "Lulus SD itu bukan akhir, tapi checkpoint pertama dalam petualangan kamu yang panjang.",
  "Bawa rasa ingin tahu ke mana pun kamu pergi. Dunia ini penuh hal keren yang nunggu kamu temukan.",
  "Gak semua jawaban ada sekarang. Tapi kalau kamu terus nanya dan nyoba, jawabannya bakal muncul pelan-pelan.",
  "Kamu nggak harus tahu semua hal sekarang. Tapi terus belajar itu kayak nyalain lampu satu-satu di jalan kamu.",
  "Kadang bingung itu bagian dari belajar. Yang penting jangan berhenti jalan.",
  "Masa depan nggak datang sekaligus. Tapi setiap langkah kecil kamu ke sekolah, dengerin guru, atau bantu teman â€” itu masa depan kamu dibangun.",
  "Jangan takut salah. Salah itu cuma bukti kalau kamu lagi berani coba."
];

    function getRandomMotivasi() {
      return motivasi[Math.floor(Math.random() * motivasi.length)];
    }

    async function checkNISN() {
      const nisnInput = document.getElementById('nisn');
      const checkBtn = document.getElementById('check-btn');
      const nisn = nisnInput.value.trim();

      // Validate NISN
      if (!nisn) {
        alert('Yah, NISN-nya jangan lupa diisi ya!');
        return;
      }
      if (!/^\d{10}$/.test(nisn)) {
        alert('NISN harus 10 digit angka!');
        return;
      }

      // Show loading state
      checkBtn.disabled = true;
      checkBtn.classList.add('loading');
      checkBtn.textContent = '';

      try {
        const response = await fetch(`https://script.google.com/macros/s/AKfycbyNdWlYQjO7KM3KGIWbu01uef3R2ODjVSKfO_UGXVcMMNG8CEhG4fI1ke6StYfnIUXC/exec?nisn=${nisn}`, {
          method: 'GET',
          headers: {
            'Accept': 'application/json'
          }
        });

        if (!response.ok) {
          throw new Error(`Server error: ${response.status}`);
        }

        const data = await response.json();
        console.log('Response Data:', data); // Debug full response
        console.log('Photo URL:', data.Link_Foto); // Debug photo URL
        displayResult(data);
      } catch (error) {
        alert('Oops, ada masalah saat menghubungi server! Coba lagi nanti ya.');
        console.error('Error:', error);
      } finally {
        // Reset button state
        checkBtn.disabled = false;
        checkBtn.classList.remove('loading');
        checkBtn.textContent = 'Cek Sekarang';
      }
    }

    function displayResult(data) {
      const resultDiv = document.getElementById('result');
      const checkSection = document.getElementById('check-section');
      if (!data || data.error || !data.Nama) {
        alert('NISN tidak ditemukan, cek lagi yuk!');
        return;
      }

      // Hide check section
      checkSection.classList.add('hidden');

      // Set data
      const photoUrl = data.Link_Foto || 'https://via.placeholder.com/150';
      document.getElementById('student-photo').src = photoUrl;
      document.getElementById('nama').innerText = data.Nama || 'N/A';
      document.getElementById('nis').innerText = `NIS: ${data.NIS || 'N/A'}`;
      document.getElementById('jk').innerText = `Jenis Kelamin: ${data.JK || 'N/A'}`;
      document.getElementById('nisn-result').innerText = `NISN: ${data.NISN || 'N/A'}`;
      document.getElementById('ttl').innerText = `TTL: ${data.TTL || 'N/A'}`;
      document.getElementById('keterangan').innerText = `Status Kelulusan: ${data.KETERANGAN || 'N/A'}`;
      document.getElementById('ucapan').innerText = data.KETERANGAN && data.KETERANGAN.toLowerCase() === 'lulus' ? 'Yay, kamu LULUS! ðŸŽ‰' : '';
      document.getElementById('motivasi').innerText = getRandomMotivasi();
      resultDiv.classList.remove('hidden');
    }

    function backToCheck() {
      const resultDiv = document.getElementById('result');
      const checkSection = document.getElementById('check-section');
      const nisnInput = document.getElementById('nisn');

      // Hide result and show check section
      resultDiv.classList.add('hidden');
      checkSection.classList.remove('hidden');

      // Reset input field and focus
      nisnInput.value = '';
      nisnInput.focus();
    }

    // Enable Enter key to submit NISN
    document.getElementById('nisn').addEventListener('keypress', function(event) {
      if (event.key === 'Enter') {
        checkNISN();
      }
    });
  </script>
</body>
</html>
